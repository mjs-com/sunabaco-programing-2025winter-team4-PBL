# スプレッドシート分析テンプレート作成手順

## 概要

「生データ」シートに出力された日報データを分析するためのシート（カテゴリ分析、担当者分析、ダッシュボード）を作成する詳細手順です。

---

## 前提条件

- 「生データ」シートにデータが出力されていること
- データの列構成が以下の通りであること：
  - A列: 日報ID
  - B列: 対象日付
  - C列: 曜日
  - D列: 週番号
  - E列: 投稿日時
  - F列: タイトル
  - G列: 本文
  - H列: カテゴリ
  - I列: 緊急フラグ
  - J列: 入力者名
  - K列: 入力者職種
  - L列: 宛先（メンション）
  - M列: 現在ステータス
  - N列: 解決日時
  - O列: 解決者名
  - P列: 解決者職種
  - Q列: 対応時間（時間）
  - R列: 期限
  - S列: 期限超過フラグ
  - T列: 返信数
  - U列: 返信文
  - V列: 特別報酬ポイント

---

## 1. カテゴリ分析シートの作成

### 1-1. シートの作成

1. スプレッドシートの下部にある「+」ボタンをクリックして新しいシートを追加
2. シート名を「カテゴリ分析」に変更（シートタブをダブルクリックして編集）

### 1-2. ピボットテーブルの作成

1. 「生データ」シートを開く
2. データ範囲を選択：
   - **方法A（推奨）: Ctrl + A を使用**
     - A1セルをクリック（またはデータ範囲内の任意のセルをクリック）
     - `Ctrl + A`（Windows）または `Cmd + A`（Mac）を押す
     - データが入力されている範囲全体が自動的に選択されます
     - **注意**: この方法では、データが入力されている範囲のみが選択されます（空白セルは含まれません）
   
   - **方法B: 手動で範囲を指定**
     - A1セルをクリック
     - シフトキーを押したまま、データの最後の行・最後の列（V列）までドラッグ
     - 例: A1からV100まで（データが100行ある場合）
   
   - **方法C: 範囲を直接入力**
     - A1セルをクリック
     - 名前ボックス（左上のセルアドレス表示欄）に `A1:V100` のように範囲を入力してEnter
     - データの行数に応じて調整（例: データが150行ある場合は `A1:V150`）

3. メニューバーから「挿入」→「ピボットテーブル」をクリック
   - **注意**: 「データ」メニューではなく「挿入」メニューにあります
4. ピボットテーブルの設定ダイアログが表示されます：
   - 「データ範囲」に選択した範囲が自動的に入力されていることを確認
   - 「新しいシートに挿入」を選択（または「既存のシートに挿入」を選択して「カテゴリ分析」シートを指定）
5. 「作成」をクリック

**補足: Ctrl + A と Ctrl + Shift + End の違い**
- **Ctrl + A**: データが入力されている範囲全体を自動的に選択（空白セルは含まれない）。最も簡単で推奨される方法。
- **Ctrl + Shift + End**: 現在のセルから、データが入力されている最後のセルまで選択。Endキーが必要で、一部のキーボードでは使用できない。

### 1-3. ピボットテーブルの設定

右側に表示される「ピボットテーブル エディタ」で以下の設定を行います：

#### 行の設定
1. 「行」セクションの「追加」をクリック
2. 「カテゴリ」（H列）を選択

#### 値の設定
1. 「値」セクションの「追加」をクリック
2. 「日報ID」（A列）を選択
3. 集計方法を「COUNTA」（カウント）に変更
   - 値の項目をクリック
   - 「集計方法」を「COUNTA」に変更
   - 表示名を「件数」に変更（オプション）

#### 結果の確認
- カテゴリごとの日報件数が表示されます
- 例：
  ```
  カテゴリ     | 件数
  ------------|------
  清掃        | 15
  備品管理    | 8
  その他      | 5
  ```

### 1-4. グラフの作成（オプション）

1. ピボットテーブルの範囲を選択
2. メニューバーから「挿入」→「グラフ」をクリック
3. グラフの種類を選択（推奨: 縦棒グラフまたは円グラフ）
4. グラフが自動的に作成されます

---

## 2. 担当者分析シートの作成

### 2-1. シートの作成

1. スプレッドシートの下部にある「+」ボタンをクリックして新しいシートを追加
2. シート名を「担当者分析」に変更

### 2-2. ピボットテーブルの作成

1. 「生データ」シートを開く
2. データ範囲を選択：
   - **推奨方法: Ctrl + A を使用**
     - データ範囲内の任意のセルをクリック
     - `Ctrl + A`（Windows）または `Cmd + A`（Mac）を押す
   - または、手動でA1からデータの最後までドラッグして選択
3. メニューバーから「挿入」→「ピボットテーブル」をクリック
   - **注意**: 「データ」メニューではなく「挿入」メニューにあります
4. ピボットテーブルの設定ダイアログが表示されます：
   - 「データ範囲」に選択した範囲が自動的に入力されていることを確認
   - 「新しいシートに挿入」を選択（または「既存のシートに挿入」で「担当者分析」シートを指定）
5. 「作成」をクリック

### 2-3. ピボットテーブルの設定

#### 行の設定
1. 「行」セクションの「追加」をクリック
2. 「入力者名」（J列）を選択

#### 値の設定（複数追加）

**値1: 日報件数**
1. 「値」セクションの「追加」をクリック
2. 「日報ID」（A列）を選択
3. 集計方法を「COUNTA」に変更
4. 表示名を「投稿件数」に変更

**値2: 平均対応時間**
1. 「値」セクションの「追加」を再度クリック
2. 「対応時間（時間）」（Q列）を選択
3. 集計方法を「AVERAGE」（平均）に変更
   - 値の項目をクリック
   - 「集計方法」を「AVERAGE」に変更
   - 表示名を「平均対応時間（時間）」に変更
   - 数値の書式を「数値」→「小数点以下1桁」に設定（オプション）

#### 結果の確認
- 担当者ごとの投稿件数と平均対応時間が表示されます
- 例：
  ```
  入力者名    | 投稿件数 | 平均対応時間（時間）
  -----------|---------|------------------
  田中かずこ  | 12      | 3.5
  小松ひろと  | 8       | 2.8
  佐藤花子    | 5       | 4.2
  ```

### 2-4. ソートの設定（オプション）

1. ピボットテーブルエディタで「行」セクションを開く
2. 「並べ替え」をクリック
3. 「投稿件数」で降順にソートするなど、必要に応じて設定

---

## 3. ダッシュボードシートの作成

### 3-1. シートの作成

1. スプレッドシートの下部にある「+」ボタンをクリックして新しいシートを追加
2. シート名を「ダッシュボード」に変更

### 3-2. KPI表示の作成

以下の手順で主要KPIを表示します。

#### 3-2-1. レイアウトの準備

1. A1セルに「日報分析ダッシュボード」と入力（見出し）
2. A1セルの書式設定：
   - フォントサイズ: 18pt
   - 太字: 有効
   - 背景色: 任意（例: 青系）

#### 3-2-2. 総日報数の表示

1. A3セルに「総日報数」と入力
2. B3セルに以下の数式を入力：
   ```
   =COUNTA(生データ!A:A)-1
   ```
   - 説明: 生データシートのA列（日報ID）の非空白セル数をカウントし、ヘッダー行（1行目）を引く

3. B3セルの書式設定：
   - 数値の書式: 「数値」→「0桁」
   - フォントサイズ: 24pt
   - 太字: 有効

#### 3-2-3. 未解決数の表示

1. A4セルに「未解決数」と入力
2. B4セルに以下の数式を入力：
   ```
   =COUNTIF(生データ!M:M,"UNREAD")+COUNTIF(生データ!M:M,"CONFIRMED")+COUNTIF(生データ!M:M,"WORKING")
   ```
   - 説明: 生データシートのM列（現在ステータス）で「UNREAD」「CONFIRMED」「WORKING」の件数を合計

3. B4セルの書式設定：
   - 数値の書式: 「数値」→「0桁」
   - フォントサイズ: 24pt
   - 太字: 有効
   - 文字色: 赤系（オプション）

#### 3-2-4. 解決数の表示

1. A5セルに「解決数」と入力
2. B5セルに以下の数式を入力：
   ```
   =COUNTIF(生データ!M:M,"SOLVED")
   ```
   - 説明: 生データシートのM列で「SOLVED」の件数をカウント

3. B5セルの書式設定：
   - 数値の書式: 「数値」→「0桁」
   - フォントサイズ: 24pt
   - 太字: 有効
   - 文字色: 緑系（オプション）

#### 3-2-5. 解決率の表示

1. A6セルに「解決率」と入力
2. B6セルに以下の数式を入力：
   ```
   =IF(COUNTA(生データ!A:A)-1>0, COUNTIF(生データ!M:M,"SOLVED")/(COUNTA(生データ!A:A)-1), 0)
   ```
   - 説明: 解決数を総日報数で割って解決率を計算（ゼロ除算を防ぐためIF関数を使用）

3. B6セルの書式設定：
   - 数値の書式: 「パーセンテージ」→「小数点以下1桁」
   - フォントサイズ: 24pt
   - 太字: 有効

#### 3-2-6. その他のKPI（オプション）

**平均対応時間**
1. A7セルに「平均対応時間（時間）」と入力
2. B7セルに以下の数式を入力：
   ```
   =AVERAGE(生データ!Q:Q)
   ```
   - 説明: 生データシートのQ列（対応時間）の平均値を計算

**緊急案件数**
1. A8セルに「緊急案件数」と入力
2. B8セルに以下の数式を入力：
   ```
   =COUNTIF(生データ!I:I,"はい")
   ```
   - 説明: 生データシートのI列（緊急フラグ）で「はい」の件数をカウント

**期限超過件数**
1. A9セルに「期限超過件数」と入力
2. B9セルに以下の数式を入力：
   ```
   =COUNTIF(生データ!S:S,"はい")
   ```
   - 説明: 生データシートのS列（期限超過フラグ）で「はい」の件数をカウント

### 3-3. 見た目の調整

1. 列幅の調整：
   - A列をダブルクリックして自動調整
   - B列を適切な幅に調整（例: 150px）

2. 罫線の追加：
   - A3:B9の範囲を選択
   - メニューバーから「表示形式」→「罫線」で罫線を追加

3. 背景色の設定（オプション）：
   - A3:A9の範囲を選択
   - 背景色を設定（例: 薄いグレー）

---

## 4. グラフの追加（オプション）

### 4-1. カテゴリ別件数のグラフ

1. 「カテゴリ分析」シートのピボットテーブルを選択
2. メニューバーから「挿入」→「グラフ」をクリック
3. グラフの種類を選択（推奨: 縦棒グラフ、横棒グラフ、円グラフ）
4. グラフのタイトルを「カテゴリ別日報件数」に変更

### 4-2. 担当者別投稿件数のグラフ

1. 「担当者分析」シートのピボットテーブルを選択
2. メニューバーから「挿入」→「グラフ」をクリック
3. グラフの種類を選択（推奨: 縦棒グラフ）
4. グラフのタイトルを「担当者別投稿件数」に変更

### 4-3. ダッシュボードへのグラフのコピー

1. 作成したグラフを右クリック→「コピー」
2. 「ダッシュボード」シートに移動
3. 適切な位置（例: D3セル付近）に貼り付け
4. グラフのサイズを調整

---

## 5. データ更新時の注意事項

### 5-1. ピボットテーブルの更新

- 「生データ」シートに新しいデータが追加された場合、ピボットテーブルは自動的に更新されません
- 手動で更新する方法：
  1. ピボットテーブルを右クリック
  2. 「データの更新」をクリック

### 5-2. 数式の自動更新

- ダッシュボードの数式は、生データが更新されると自動的に再計算されます
- 特別な操作は不要です

---

## 6. トラブルシューティング

### 問題: ピボットテーブルにデータが表示されない

**原因と対処:**
- データ範囲が正しく選択されていない
  - 対処: ピボットテーブルエディタで「データ範囲」を確認し、正しい範囲を指定
- 列名が一致していない
  - 対処: 「生データ」シートのヘッダー行（1行目）を確認

### 問題: 数式でエラーが表示される（#DIV/0! など）

**原因と対処:**
- ゼロ除算が発生している
  - 対処: IF関数でゼロ除算を防ぐ（例: `=IF(分母>0, 分子/分母, 0)`）
- データがまだ存在しない
  - 対処: データが追加されるまで待つか、数式を修正してエラーを回避

### 問題: グラフが正しく表示されない

**原因と対処:**
- データ範囲が正しく選択されていない
  - 対処: グラフを選択して「データ範囲の編集」で確認
- データの形式が正しくない
  - 対処: 数値データが数値形式になっているか確認

---

## 7. カスタマイズのヒント

### 7-1. フィルタの追加

ピボットテーブルにフィルタを追加することで、特定の期間や条件でデータを絞り込めます：

1. ピボットテーブルエディタで「フィルタ」セクションを開く
2. 「追加」をクリック
3. フィルタしたい列（例: 「対象日付」「現在ステータス」）を選択
4. 条件を設定（例: 「対象日付」が「2025年11月」など）

### 7-2. 条件付き書式の追加

ダッシュボードのKPIに条件付き書式を設定することで、視覚的に分かりやすくできます：

1. KPIのセル（例: B4「未解決数」）を選択
2. メニューバーから「表示形式」→「条件付き書式」をクリック
3. 条件を設定（例: 「値が10より大きい場合は赤色」など）

### 7-3. スライサーの追加

スライサーを使用すると、ピボットテーブルを簡単にフィルタリングできます：

1. ピボットテーブルを選択
2. メニューバーから「データ」→「スライサーを挿入」をクリック
3. フィルタしたい列を選択（例: 「対象日付」「カテゴリ」）

---

*作成日: 2025年12月15日*
